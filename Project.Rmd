---
title: "Impact of renewable energy sources"
author: "Burgaletta Francesco"
date: "August 21, 2023"
output:
  ioslides_presentation:
    css: style.css
  html_document: default
  pdf_document: default
  beamer_presentation: default
  slidy_presentation: default
editor_options:
  chunk_output_type: inline
---

```{r setup, include=FALSE}
# cache results
knitr::opts_chunk$set(cache=TRUE, echo = TRUE, eval = TRUE, message=FALSE, warning = FALSE, fig.align='center')
```

## Overview

Given the increasing media coverage of renewable energy sources and people's interest in them, one could ask the following questions:

1. How does the use of fossil fuels relate to life expectancy?
2. How are investments in renewables related to their effective adoption and to the available resources?
3. What are the growth prospects of renewables' usage?

## The datasets

The datasets used for this data analysis incorporate the relationship between all the countries grouped by regions, the year and multiple quantities. These quantities are:

1. Energy production from oil, gas, coal, wind, solar, hydroelectric and nuclear.
2. Economic and financial indicators, in this case GDP and investments in renewables.
3. Demographic indicators such as population size and life expectancy.

```{r, evaluate = TRUE, echo = FALSE}
#install.packages("igraph")
#install.packages("tidyverse")
#install.packages("dplyr")
library(igraph)
library(tibble)
library(readr)
library(tidyr)
library(tidyverse)
library(dplyr)

wd = getwd()

dataset_oil = paste(wd, "/Oil.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  select(c(1,3,4)) %>%
  transform(Year = as.integer(Year)) %>% filter(Year >= 2000 & Year <= 2020) %>%
  arrange(Entity, Year)

dataset_gas = paste(wd, "/Gas.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  select(c(1,3,4)) %>%
  transform(Year = as.integer(Year)) %>% filter(Year >= 2000 & Year <= 2020) %>%
  arrange(Entity, Year)

dataset_coal = paste(wd, "/Coal.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  select(c(1,3,4)) %>%
  transform(Year = as.integer(Year)) %>% filter(Year >= 2000 & Year <= 2020) %>%
  arrange(Entity, Year)

dataset_wind = paste(wd, "/Wind.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  select(c(1,3,4)) %>%
  transform(Year = as.integer(Year)) %>% filter(Year >= 2000 & Year <= 2020) %>%
  arrange(Entity, Year)

dataset_solar = paste(wd, "/Solar.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  select(c(1,3,4)) %>%
  transform(Year = as.integer(Year)) %>% filter(Year >= 2000 & Year <= 2020) %>%
  arrange(Entity, Year)

dataset_hydroelectric = paste(wd, "/Hydroelectric.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  select(c(1,3,4)) %>%
  transform(Year = as.integer(Year)) %>% filter(Year >= 2000 & Year <= 2020) %>%
  arrange(Entity, Year)

dataset_nuclear = paste(wd, "/Nuclear.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  select(c(1,3,4)) %>%
  transform(Year = as.integer(Year)) %>% filter(Year >= 2000 & Year <= 2020) %>%
  arrange(Entity, Year)

names(dataset_oil)[c(1,3)] = c("Region", "Oil")
names(dataset_gas)[c(1,3)] = c("Region", "Gas")
names(dataset_coal)[c(1,3)] = c("Region", "Coal")
names(dataset_wind)[c(1,3)] = c("Region", "Wind")
names(dataset_solar)[c(1,3)] = c("Region", "Solar")
names(dataset_hydroelectric)[c(1,3)] = c("Region", "Hydroelectric")
names(dataset_nuclear)[c(1,3)] = c("Region", "Nuclear")



dataset_investments = paste(wd, "/Investments in renewables.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  filter(Category == "Renewables") %>%
  select(c(7,15)) %>%
  transform(Year = as.integer(Year)) %>% filter(Year >= 2000 & Year <= 2020)

names(dataset_investments)[c(1,2)] = c("Year", "Amount")

dataset_investments = dataset_investments %>%
  group_by(Year) %>%
  summarise(Amount = 1000000 * sum(Amount)) %>%
  arrange(Year)



dataset_life = paste(wd, "/Life expectancy.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  select(c(1,3,4)) %>%
  transform(Year = as.integer(Year)) %>% filter(Year >= 2000 & Year <= 2020)

names(dataset_life)[c(1,3)] = c("Region", "LifeExpectancy")



dataset_emissions = paste(wd, "/CO2 emissions.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  select(c(1,3,4))

names(dataset_emissions)[c(1,3)] = c("Region", "CO2Emissions")

dataset_emissions = dataset_emissions %>%
  transform(Year = as.integer(Year)) %>% filter(Year >= 2000 & Year <= 2020) %>%
  arrange(Region, Year)



dataset_population = paste(wd, "/Population.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  select(c(1,3,4))

names(dataset_population)[1] = "Region"

dataset_population = dataset_population %>%
  transform(Year = as.integer(Year)) %>% filter(Year >= 2000 & Year <= 2020) %>%
  arrange(Region, Year)



dataset_gdp = paste(wd, "/GDP.csv", sep = "") %>% read_csv() %>% as_tibble()

names(dataset_gdp)[1] = "Region"

dataset_gdp = dataset_gdp %>%
  pivot_longer(paste(1980:2028), names_to = "Year", values_to = "GDPBillions") %>%
  transform(Year = as.integer(Year), GDPBillions = as.double(GDPBillions)) %>% filter(Year >= 2000 & Year <= 2020) %>%
  mutate(GDP = 1000000000 * GDPBillions) %>%
  select(Region, Year, GDP) %>%
  arrange(Region, Year)



dataset_countries = paste(wd, "/Countries.csv", sep = "") %>% read_csv() %>% as_tibble() %>%
  select(1)

dataset_countries[nrow(dataset_countries) + 1,] <- "World"

names(dataset_countries)[1] = "Region"

dataset_countries = inner_join(dataset_countries, dataset_oil, by = "Region") %>% select(1) %>% distinct()
dataset_countries = inner_join(dataset_countries, dataset_life, by = "Region") %>% select(1) %>% distinct()
dataset_countries = inner_join(dataset_countries, dataset_emissions, by = "Region") %>% select(1) %>% distinct()
dataset_countries = inner_join(dataset_countries, dataset_population, by = "Region") %>% select(1) %>% distinct()
dataset_countries = inner_join(dataset_countries, dataset_gdp, by = "Region") %>% select(1) %>% distinct()



dataset_energy = full_join(dataset_oil, dataset_gas, by = c("Region", "Year"))
dataset_energy = full_join(dataset_energy, dataset_coal, by = c("Region", "Year"))
dataset_energy = full_join(dataset_energy, dataset_wind, by = c("Region", "Year"))
dataset_energy = full_join(dataset_energy, dataset_solar, by = c("Region", "Year"))
dataset_energy = full_join(dataset_energy, dataset_hydroelectric, by = c("Region", "Year"))
dataset_energy = full_join(dataset_energy, dataset_nuclear, by = c("Region", "Year")) %>%
  replace(is.na(.), 0) %>%
  mutate(FossilFuels = Oil + Gas + Coal, Renewables = Wind + Solar + Hydroelectric + Nuclear) %>%
  select(Region, Year, FossilFuels, Renewables)
```

## CO2 emissions

CO2 emissions, fossil fuels' usage, GDP per capita and life expectancy are deeply linked

```{r, evaluate = TRUE, echo = FALSE}
#install.packages("patchwork")
#install.packages("ggrepel")
library(ggplot2)
library(ggrepel)
library(patchwork)

mytheme = list(
    theme_classic() +
        theme(panel.background = element_blank(),
              strip.background = element_rect(colour=NA, fill=NA),
              panel.border = element_rect(fill = NA, color = "black"),
              strip.text = element_text(face="bold", size = 9),
              axis.text=element_text(face="bold"),
              axis.title = element_text(face="bold"),
              plot.title = element_text(face = "bold", hjust = 0.5,size = 13),
              panel.grid.major = element_line(color = 'lightgrey', size = 0.25),
              panel.grid.minor = element_line(color = 'lightgrey', size = 0.25))
)

dataset_gdp_per_capita = inner_join(dataset_gdp, dataset_population, by = c("Region", "Year")) %>%
  mutate(GDPPerCapita = GDP / Population) %>%
  select(Region, Year, GDPPerCapita)

plot_emissions = ggplot() +
  geom_line(data = dataset_emissions %>% filter(Region != "World"), mapping = aes(x = Year, y = CO2Emissions, group = Region), size = 1, color = "#FFC896", alpha = 0.2) +
  geom_line(data = dataset_emissions %>% filter(Region == "World"), mapping = aes(x = Year, y = CO2Emissions), size = 1.5, color = "#80644B") +
  labs(title="Global CO2 emissions", x ="Year", y = "CO2 emissions (T)") +
  mytheme

plot_energy = ggplot() +
  geom_line(data = dataset_energy %>% filter(Region != "World"), mapping = aes(x = Year, y = FossilFuels, group = Region), size = 1, color = "#FFC896", alpha = 0.2) +
  geom_line(data = dataset_energy %>% filter(Region == "World"), mapping = aes(x = Year, y = FossilFuels), size = 1.5, color = "#80644B") +
  labs(title="Fossil fuels' energy output", x ="Year", y = "Energy output (TWh)") +
  mytheme

plot_gdp_per_capita = ggplot() +
  geom_line(data = dataset_gdp_per_capita %>% filter(Region != "World"), mapping = aes(x = Year, y = GDPPerCapita, group = Region), size = 1, color = "#FFC896", alpha = 0.2) +
  geom_line(data = dataset_gdp_per_capita %>% filter(Region == "World"), mapping = aes(x = Year, y = GDPPerCapita), size = 1.5, color = "#80644B") +
  labs(title="Global average GDP per capita", x ="Year", y = "GDP per capita (USD)") +
  mytheme

plot_life_expectancy = ggplot() +
  geom_line(data = dataset_life %>% filter(Region != "World"), mapping = aes(x = Year, y = LifeExpectancy, group = Region), size = 1, color = "#FFC896", alpha = 0.2) +
  geom_line(data = dataset_life %>% filter(Region == "World"), aes(x = Year, y = LifeExpectancy), size = 1.5, color = "#80644B") +
  labs(title="Global average life expectancy", x ="Year", y = "Life expectancy (years)") +
  mytheme

(plot_emissions + plot_energy) / (plot_gdp_per_capita + plot_life_expectancy)
```
 
## CO2 emissions

CO2 emissions, fossil fuels' usage, GDP per capita and life expectancy grow in the same fashion.

Life expectancy is linked to the GDP per capita, which in turn is linked to the use of fossil fuels', that emit more CO2.

## Investments

Investments in the field of renewables rose significantly in 2009, but are very limited proportionally to the available resources.

```{r, evaluate = TRUE, echo = FALSE}
dataset_efficiency = full_join(dataset_investments, dataset_energy %>% filter(Region == "World") %>% select(c(2,3,4)), by = "Year") %>%
  replace(is.na(.), 0) %>%
  group_by(Year) %>%
  summarise(Amount = sum(Amount), Renewables = sum(Renewables)) %>%
  mutate(Efficiency = Renewables / Amount) %>%
  select(Year, Efficiency) %>%
  arrange(Year)

dataset_percentage = full_join(dataset_investments, dataset_gdp %>% filter(Region == "World") %>% select(c(2,3)), by = "Year") %>%
  replace(is.na(.), 0) %>%
  mutate(Percentage = 100 * Amount / GDP) %>%
  select(Year, Percentage) %>%
  arrange(Year)

plot_efficiency = ggplot() +
  geom_rect(data = dataset_efficiency, aes(xmin=2009, xmax=2020, ymin = -Inf, ymax = Inf), fill = "#00A6FF", alpha = 0.02) +
  geom_bar(data = dataset_efficiency, mapping = aes(x = Year, y = Efficiency), position="dodge", stat="identity", fill = "#005380", width = 0.5) +
  labs(title="Ratio between renewables' energy\noutput and the amount of\ninvestments in renewables globally", x ="Year", y = "Ratio (TWh/USD)") +
  mytheme

plot_percentage = ggplot() +
  geom_rect(data = dataset_percentage, aes(xmin=2009, xmax=2020, ymin = -Inf, ymax = Inf), fill = "#00A6FF", alpha = 0.02) +
  geom_bar(data = dataset_percentage, mapping = aes(x = Year, y = Percentage), position="dodge", stat="identity", fill = "#005380", width = 0.5) +
  labs(title="Investments in renewables as\npercentage of GDP globally", x ="Year", y = "Percentage (%)") +
  mytheme

plot_gdp = ggplot() +
  geom_rect(data = dataset_energy %>% filter(Region == "World"), aes(xmin=2009, xmax=2020, ymin = -Inf, ymax = Inf), fill = "#00A6FF", alpha = 0.02) +
  geom_bar(data = dataset_energy %>% filter(Region == "World"), mapping = aes(x = Year, y = Renewables), position="dodge", stat="identity", fill = "#005380", width = 0.5) +
  labs(title="Global Renewables' energy output", x ="Year", y = "Energy output (TWh)") +
  mytheme

plot_absolute = ggplot() +
  geom_rect(data = dataset_investments, aes(xmin=2009, xmax=2020, ymin = -Inf, ymax = Inf), fill = "#00A6FF", alpha = 0.02) +
  geom_bar(data = dataset_investments, mapping = aes(x = Year, y = Amount), position="dodge", stat="identity", fill = "#005380", width = 0.5) +
  labs(title="Investments in renewables\nglobally", x ="Year", y = "Investments (USD)") +
  mytheme

(plot_efficiency + plot_percentage) / (plot_gdp + plot_absolute)
```

## Investments

After 2009, no significant increase in renewables' employment given the investments.

The high start in efficiency is due to the almost absent investments.

The high end in efficiency is due to the simultaneous decrease in investments and increase in renewables' usage.

Average investments' amounts peak at 0.025% of GDP, corresponding to about 30 billion USD globally.

## Renewables

Renewables' usage has grown in the last decades

```{r, evaluate = TRUE, echo = FALSE}
dataset_percentage = dataset_energy %>%
  mutate(Percentage = 100 * Renewables / (Renewables + FossilFuels)) %>%
  select(Region, Year, Percentage)

dataset_renewables_to_population = inner_join(dataset_energy, dataset_population, by = c("Region", "Year")) %>%
  mutate(Amount = Renewables / Population)

plot_renewables_percentage = ggplot() +
  geom_jitter(data = dataset_percentage %>% filter(Region != "World"), aes(x = Year, y = Percentage, group = Year), position=position_jitter(0.1), color = "#FF8F8C") +
  geom_boxplot(data = dataset_percentage %>% filter(Region != "World"), aes(x = Year, y = Percentage, group = Year), fill = "#FF8F8C") +
  labs(title="Renewables' percentage on all\nenergy sources for all countries", x ="Year", y = "Percentage (%)") +
  mytheme

plot_renewables_to_population = ggplot() +
  geom_jitter(data = dataset_renewables_to_population %>% filter(Region != "World"), aes(x = Year, y = Amount, group = Year), position=position_jitter(0.1), color = "#FF8F8C") +
  geom_boxplot(data = dataset_renewables_to_population %>% filter(Region != "World"), aes(x = Year, y = Amount, group = Year), fill = "#FF8F8C") +
  labs(title="Renewable energy at disposal for\nevery citizen for all countries", x ="Year", y = "Renewable energy (TWh/person)") +
  mytheme

plot_renewables_percentage + plot_renewables_to_population
```

## Renewables

Renewables' usage has grown to around 15% at the current time.

The amount of renewable energy each citizen in the world has access to has increased proportionally.

## Renewables

```{r, evaluate = TRUE, echo = FALSE}
plot_renewables_percentage_forecast = ggplot() +
  geom_vline(xintercept = 2020, linetype="dashed", color = "#000000", size = 1) +
  geom_vline(xintercept = 2009, linetype="dashed", color = "#000000", size = 1) +
  geom_text(aes(x=2007, label="Start of investments", y=22), colour="#000000", angle = 90) +
  geom_text(aes(x=2018, label="Current time", y = 22), colour="#000000", angle = 90) +
  geom_smooth(data = dataset_percentage %>% filter(Region == "World" & Year >= 2009), aes(x = Year, y = Percentage), color = "#000000", method = "lm", formula = y ~ poly(x, 3), se=FALSE, size = 1, fullrange=TRUE) +
  geom_smooth(data = dataset_percentage %>% filter(Region == "World" & Year >= 2009), aes(x = Year, y = Percentage), color = "#000000", method = "lm", se=FALSE, size = 1, fullrange=TRUE) +
  geom_point(data = dataset_percentage %>% filter(Region == "World"), aes(x = Year, y = Percentage), color = "#FF8F8C", size = 1.5) +
  expand_limits(x = 2030) +
  labs(title="Renewables' percentage\non all energy sources globally", x ="Year", y = "Percentage (%)") +
  mytheme

plot_renewables_to_population_forecast = ggplot() +
  geom_vline(xintercept = 2020, linetype="dashed", color = "#000000", size = 1) +
  geom_vline(xintercept = 2009, linetype="dashed", color = "#000000", size = 1) +
  geom_text(aes(x=2007, label="Start of investments", y=0.000004), colour="#000000", angle = 90) +
  geom_text(aes(x=2018, label="Current time", y=0.000004), colour="#000000", angle = 90) +
  geom_smooth(data = dataset_renewables_to_population %>% filter(Region == "World" & Year >= 2009), aes(x = Year, y = Amount), color = "#000000", method = "lm", formula = y ~ poly(x, 3), se=FALSE, size = 1, fullrange=TRUE) +
  geom_smooth(data = dataset_renewables_to_population %>% filter(Region == "World" & Year >= 2009), aes(x = Year, y = Amount), color = "#000000", method = "lm", se=FALSE, size = 1, fullrange=TRUE) +
  geom_point(data = dataset_renewables_to_population %>% filter(Region == "World"), aes(x = Year, y = Amount), color = "#FF8F8C", size = 1.5) +
  expand_limits(x = 2030) +
  labs(title="Renewable energy at disposal\nfor every citizen globally", x ="Year", y = "Renewable energy (TWh/person)") +
  mytheme

plot_renewables_percentage_forecast + plot_renewables_to_population_forecast
```

## Renewables

Starting from 2009, the starting year of investments, the percentage of renewable energy sources is projected to reach 25% in 10 to 40 years, depending on the regression analysis.

In the same period, the amount of renewable energy each citizen has access to will grow comparably.

## Conclusions

In conclusion:

1. Quality of life is deeply connected to the activity of the industrial complex. Thus, abrupt cuts in energy production from fossil fuels will result in a loss in life expectancy. This has to be kept in mind before planning any transition to renewables.
2. An increase in investments in renewables, even up to 100 fold, is required, but a subsequent effective employment of said energy sources is required even more
3. Since the start of investments we've seen an increase of about 3% in renewwables usage among all energy sources. This is the result of past investments that need to be increased, otherwise, given the late decrease, we might delay the expectations a lot.